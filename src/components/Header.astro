---
const path = Astro.url.pathname.split("/").filter(Boolean);
const isHome = path.length === 0;
const isActive = (href) => Astro.url.pathname === href;
---

<header class="site-header">
  <div class="header-inner">
    <div class="brand-wrap">
      {!isHome && (
        <button
          onclick="history.back()"
          class="back-btn"
          aria-label="go back"
        >
          ‚Üê
        </button>
      )}
      <a href="/" class="brand-link">
        <span class="brand-dot"></span>
        <span class="brand-title">Abinash S</span>
        <span class="brand-sub">Software Engineer</span>
      </a>
    </div>

    <nav class="nav-links">
      <a href="/resume" class={`nav-link ${isActive("/resume") ? "is-active" : ""}`}>
        <span class="nav-icon">‚éØ</span>
        Resume
      </a>
      <a href="/service" class={`nav-link ${isActive("/service") ? "is-active" : ""}`}>
        <span class="nav-icon">‚óà</span>
        Service
      </a>
      <a href="/contact" class={`nav-link ${isActive("/contact") ? "is-active" : ""}`}>
        <span class="nav-icon">‚ú¶</span>
        Contact
      </a>
    </nav>

    <div class="header-actions">
      <button id="navToggle" class="menu-btn" type="button">Menu</button>
      <div id="navMenu" class="menu-panel">
        <a href="/resume" class={`menu-link ${isActive("/resume") ? "is-active" : ""}`}>
          <span class="nav-icon">‚éØ</span>
          Resume
        </a>
        <a href="/service" class={`menu-link ${isActive("/service") ? "is-active" : ""}`}>
          <span class="nav-icon">‚óà</span>
          Service
        </a>
        <a href="/contact" class={`menu-link ${isActive("/contact") ? "is-active" : ""}`}>
          <span class="nav-icon">‚ú¶</span>
          Contact
        </a>
      </div>
      <span class="flag" aria-label="India">üáÆüá≥</span>
      <a class="github-btn" href="https://github.com/AbiXnash" target="_blank">
        <svg class="gh-icon" viewBox="0 0 24 24" aria-hidden="true">
          <path
            fill="currentColor"
            d="M12 2C6.48 2 2 6.58 2 12.28c0 4.52 2.87 8.36 6.84 9.72.5.1.68-.22.68-.48v-1.7c-2.78.62-3.37-1.4-3.37-1.4-.45-1.16-1.1-1.47-1.1-1.47-.9-.63.07-.62.07-.62 1 .07 1.53 1.05 1.53 1.05.9 1.56 2.36 1.11 2.94.85.09-.67.35-1.11.63-1.37-2.22-.26-4.56-1.14-4.56-5.05 0-1.12.39-2.03 1.03-2.75-.1-.26-.45-1.32.1-2.75 0 0 .84-.28 2.75 1.05a9.4 9.4 0 0 1 5 0c1.91-1.33 2.75-1.05 2.75-1.05.55 1.43.2 2.49.1 2.75.64.72 1.03 1.63 1.03 2.75 0 3.92-2.34 4.78-4.57 5.03.36.32.68.94.68 1.9v2.82c0 .26.18.58.69.48A10.3 10.3 0 0 0 22 12.28C22 6.58 17.52 2 12 2z"
          ></path>
        </svg>
        <span>GitHub</span>
      </a>
    </div>
  </div>
</header>

<style>
  .site-header {
    position: sticky;
    top: 0;
    z-index: 50;
    backdrop-filter: blur(18px);
    background: rgba(17, 17, 27, 0.32);
    border-bottom: 1px solid rgba(205, 214, 244, 0.08);
  }

  .header-inner {
    max-width: 1080px;
    margin: 0 auto;
    padding: 0.9rem 1.4rem;
    display: flex;
    align-items: center;
    justify-content: space-between;
    gap: 1rem;
  }

  .brand-wrap {
    display: flex;
    align-items: center;
    gap: 0.6rem;
  }

  .back-btn {
    color: var(--text-dim);
    font-size: 0.9rem;
  }

  .brand-link {
    display: inline-flex;
    align-items: center;
    gap: 0.6rem;
    white-space: nowrap;
  }

  .brand-dot {
    width: 10px;
    height: 10px;
    border-radius: 999px;
    background: var(--accent-alt);
    box-shadow: 0 0 12px rgba(145, 180, 255, 0.6);
  }

  .brand-title {
    font-family: "Fraunces", serif;
    font-size: 1rem;
    color: var(--text-primary);
  }

  .brand-sub {
    font-size: 0.68rem;
    letter-spacing: 0.14em;
    text-transform: uppercase;
    color: var(--text-dim);
    white-space: nowrap;
  }

  .nav-links {
    display: none;
    gap: 0.8rem;
  }

  .nav-link {
    padding: 0.35rem 0.9rem;
    border-radius: 999px;
    color: var(--text-muted);
    font-size: 0.85rem;
    transition: all 160ms ease;
    display: inline-flex;
    align-items: center;
    gap: 0.4rem;
  }

  .nav-link:hover,
  .nav-link.is-active {
    color: var(--text-primary);
    background: rgba(255, 255, 255, 0.1);
  }

  .header-actions {
    display: flex;
    align-items: center;
    gap: 0.8rem;
    position: relative;
  }

  .menu-btn {
    border-radius: 999px;
    border: 1px solid rgba(205, 214, 244, 0.18);
    padding: 0.35rem 0.8rem;
    font-size: 0.75rem;
    color: var(--text-primary);
    background: rgba(17, 17, 27, 0.55);
  }

  .menu-panel {
    position: absolute;
    right: 0;
    top: 2.9rem;
    width: min(240px, 80vw);
    display: none;
    flex-direction: column;
    gap: 0.4rem;
    padding: 0.7rem;
    border-radius: 18px;
    border: 1px solid rgba(205, 214, 244, 0.14);
    background: rgba(17, 17, 27, 0.92);
    box-shadow: 0 18px 40px rgba(0, 0, 0, 0.35);
    backdrop-filter: blur(18px);
  }

  .menu-panel.is-open {
    display: flex;
  }

  .flag {
    font-size: 1rem;
    line-height: 1;
  }

  .github-btn {
    border-radius: 999px;
    border: 1px solid rgba(205, 214, 244, 0.18);
    padding: 0.35rem 0.8rem;
    font-size: 0.75rem;
    color: #cdd6f4;
    background: rgba(17, 17, 27, 0.75);
    transition: all 160ms ease;
    display: inline-flex;
    align-items: center;
    gap: 0.45rem;
  }

  .github-btn:hover {
    border-color: rgba(137, 180, 250, 0.45);
    background: rgba(17, 17, 27, 0.95);
    transform: translateY(-1px);
  }

  .gh-icon {
    width: 14px;
    height: 14px;
  }

  .menu-link {
    padding: 0.55rem 0.7rem;
    border-radius: 12px;
    color: var(--text-muted);
    font-size: 0.9rem;
    display: inline-flex;
    align-items: center;
    gap: 0.5rem;
  }

  .menu-link.is-active,
  .menu-link:hover {
    color: var(--text-primary);
    background: rgba(137, 180, 250, 0.14);
  }

  .nav-icon {
    font-size: 0.8rem;
    opacity: 0.7;
  }

  @media (min-width: 860px) {
    .nav-links {
      display: flex;
    }

    .menu-btn {
      display: none;
    }
  }

  @media (max-width: 859px) {
    .menu-panel {
      position: fixed;
      left: 1rem;
      right: 1rem;
      bottom: 1rem;
      top: auto;
      width: auto;
      border-radius: 20px;
      padding: 0.9rem;
      transform: translateY(12px);
      opacity: 0;
      transition: opacity 180ms ease, transform 180ms ease;
    }

    .menu-panel.is-open {
      opacity: 1;
      transform: translateY(0);
    }
  }
</style>

<script>
  document.addEventListener("DOMContentLoaded", () => {
    const toggle = document.getElementById("navToggle");
    const menu = document.getElementById("navMenu");
    if (!toggle || !menu) return;

    toggle.addEventListener("click", (event) => {
      event.stopPropagation();
      menu.classList.toggle("is-open");
    });

    menu.addEventListener("click", (event) => {
      event.stopPropagation();
    });

    document.addEventListener("click", () => {
      menu.classList.remove("is-open");
    });
  });
</script>
